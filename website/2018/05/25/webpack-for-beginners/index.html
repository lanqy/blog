<!--
 * @Author: Leland
 * @Date: 2019-12-27 15:59:00
 * @Description: Description
 -->
<!doctype html>
<html>

  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui" />
    <title>Webpack 给初学者</title>
    <link href="/css/style.css" rel="stylesheet" />
    <meta name="description" content="Webpack 给初学者">
  </head>

  <body>
    <div>
      <div>
        <header class="header">
          <div class="container header-wrap">
            <h1 class="site-name">
              <a href="/">
                首页
              </a>
            </h1>
            <ul class="nav">
              <li class="nav-item">
                <a href="/about">关于</a>
              </li>
            </ul>
          </div>
        </header>
      </div>
      <div class="container main">
        <div class="page-body">
          <div class="markdown-body">
            <h1>Webpack 给初学者</h1>
            <h3>Webpack 是什么？</h3>
            <p>Webpack是一个模块打包和压缩工具</p>
            <h3>什么是模块打包？</h3>
            <p>模块打包就是把多个Javascript文件打包和压缩成一个单独的Javascript文件</p>
            <h3>怎样使用？</h3>
            <p>开始创建一个项目</p>
            <pre><code class="language-shell">$ mkdir try-webpack && cd try-webpack && mkdir src && npm init -y
$ touch index.html && touch src/main.js && touch webpack.config.js
</code></pre>
            <p>如果你是Windows用户，可以通过<a href="https://git-scm.com/downloads" target="_blank">git bash</a>运行上面的命令。现在我们开始全局安装webpack:</p>
            <pre><code class="language-javascript">$ npm install <span class="token operator">-</span>g webpack
</code></pre>
            <p>我们通过一个简单的配置文件开始我们所有的前端项目，打开<code>webpack.config.js</code>文件，复制下面的代码粘贴到<code>webpack.config.js</code>中</p>
            <pre><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devtool<span class="token operator">:</span> <span class="token string">'cheap-module-eval-source-map'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">"./src/main.js"</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> __dirname <span class="token operator">+</span> <span class="token string">"/dist"</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">"bundle.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
            <p>这个文件告诉webpack我们的应用入口点在哪里，以及在哪个目录输出打包后的代码，通过命令行运行<code>webpack</code>,在dist目录下就会生成bundle.js文件。到目前为止，我们到应用是相当无聊的，我是<a href="http://mithril.js.org/" target="_blank">Mithril.js</a>的忠实粉丝,因此我们通过<a href="http://mithril.js.org/" target="_blank">Mithril.js</a>来做一些东西，首先通过npm来安装这个库。</p>
            <pre><code class="language-javascript">$ npm install <span class="token operator">--</span>save mithril
</code></pre>
            <p>现在打开<code>src/main.js</code>输入如下代码：</p>
            <pre><code class="language-javascript"><span class="token keyword">var</span> m <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mithril'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">view</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token string">'hello world!'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

m<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> app<span class="token punctuation">)</span>
</code></pre>
            <p>打开index.html,输入如下代码（请记得引入打包后的bundle.js文件）:</p>
            <pre><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Webpack Tutorial<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dist/bundle.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
            <p>接着通过命令行运行<code>webpack</code>生成新的包（bundle.js文件），现在在浏览器中打开index.html,你将看到<code>hello world!</code> 。
              如果你做到来这一步，那么恭喜你！你已经理解基本的webpack了。<br /></p>
            <p>让我们来稍微重构一下我们的app，我们来本地化我们的应用程序，这个要求我们把所有文本放在一个集中的地方，创建一个新的文件<code>src/resources.json</code>,这个文件里包含如下的JSON：</p>
            <pre><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"en-US"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"HELLO_WORLD"</span><span class="token operator">:</span> <span class="token string">"hello world!"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
            <p>回到<code>src/main.js</code>文件，通过json文件加载我们的信息（修改该文件为)：</p>
            <pre><code class="language-javascript"><span class="token keyword">var</span> m <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mithril'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> resources <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./resources.json'</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">view</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> resources<span class="token punctuation">[</span><span class="token string">'en-US'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token constant">HELLO_WORLD</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

m<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> app<span class="token punctuation">)</span>
</code></pre>
            <br />
            如果你迫不及待的想在命令行运行`webpack`，你将会看到类似于如下的错误信息
            <pre><code class="language-javascript"><span class="token constant">ERROR</span> <span class="token keyword">in</span> <span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>main<span class="token punctuation">.</span>js
Module not found<span class="token operator">:</span> Error<span class="token operator">:</span> Cannot resolve <span class="token string">'file'</span> or <span class="token string">'directory'</span> <span class="token punctuation">.</span><span class="token operator">/</span>resources<span class="token punctuation">.</span>json <span class="token keyword">in</span> <span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token keyword">try</span><span class="token operator">-</span>webpack<span class="token operator">/</span>src
 @ <span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>main<span class="token punctuation">.</span>js <span class="token number">2</span><span class="token operator">:</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">43</span>
</code></pre>
            <p>这个是loaders(加载器)报的错误，加载器是非常方便的工具，它可以使我们处理不同类型的内容。
              <br />
              加载器可以用于转换ES2015成ES5，转换React JSX，编译TypeScript，加载Handlebars模版，加载和执行CSS，编译CSS预处理SASS，等等。有数以百计的加载器为不同的目的而诞生，现在我们只需要关心<code>json-loader</code>这个加载器。
              <br />
              同样，我们通过npm来安装<code>json-loader</code>：
            </p>
            <pre><code class="language-shell">$ npm install --save-dev json-loader
</code></pre>
            <p>我们需要修改一下我们的<code>webpack.config.js</code>文件，引入我们的加载器，具体如下：</p>
            <pre><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devtool<span class="token operator">:</span> <span class="token string">'cheap-module-eval-source-map'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">"./src/main.js"</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> __dirname <span class="token operator">+</span> <span class="token string">"/dist"</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">"bundle.js"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    loaders<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.json$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token string">'json-loader'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
            <p>再一次运行<code>webpack</code>,你的应用应该可以启动和运行了，如果你厌倦了每次输入WebPack，你也可以运行<code>webpack -w</code>来激活文件自动检测功能，这样当任何文件修改时自动重新打包。</p>
            <br />
            让我们来做最后一件事，您可能已经注意到了生成包是相当大的，对于这样一个简单的应用程序来说，多出来的文件大小时由于`webpack.config.js`文件中`devtool:cheap-module-eval-source-map`这行造成的。这行为我们包生成源码地图（source maps），并映射到原始文件，方便查看源码和调试。当我们发布生产时，我们必须确保没有这行代码，怎样去掉这行取决于你自己，但是现在我们仅仅手工删除这一行代码。让我们也安装本地的webpack，这样我们才可以使用UglifyJsPlugin插件。
            <br />
            安装本地webpack
            <pre><code class="language-shell">$ npm install --save-dev webpack
</code></pre>
            <p>当我们准备把项目发布生成时，我们需要压缩打包的代码，Webpack可以帮你完成，让我们最后一次修改<code>webpack.config.js</code>文件：</p>
            <pre><code class="language-javascript"><span class="token keyword">var</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">"./src/main.js"</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> __dirname <span class="token operator">+</span> <span class="token string">"/dist"</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">"bundle.js"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    loaders<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.json$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token string">'json-loader'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      compress<span class="token operator">:</span> <span class="token punctuation">{</span>
        warnings<span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
            <p>再一次运行 <code>webpack</code> 生成发布生成的压缩文件（bundle.js），如果以上你漏掉来哪一步，请在github上查看<a href="https://github.com/rwhitmire/webpack-demo">webpack-demo</a>,或者在Twitter上随时联系作者<a href="https://twitter.com/ry_js">@ry_js</a>。</p>
            <p>注：本文翻译自 <a href="http://rwhitmire.com/2016/04/09/webpack-for-beginners.html">Webpack for Beginners</a>,已经在Twitter上征得原作者的同意。另外为了方便理解，我加上来一些我自己的理解（不是直译），第一次尝试翻译，有不对的地方欢迎指正，谢谢！：）</p>

          </div>
        </div>
      </div>
    </div>
  </body>

</html>