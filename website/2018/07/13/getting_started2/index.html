<!--
 * @Author: Leland
 * @Date: 2019-12-27 15:59:00
 * @Description: Description
 -->
<!doctype html>
<html>

  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui" />
    <title>OCaml简介第2部分</title>
    <link href="/css/style.css" rel="stylesheet" />
    <meta name="description" content="OCaml简介第2部分">
  </head>

  <body>
    <div>
      <div>
        <header class="header">
          <div class="container header-wrap">
            <h1 class="site-name">
              <a href="/">
                首页
              </a>
            </h1>
            <ul class="nav">
              <li class="nav-item">
                <a href="/about">关于</a>
              </li>
            </ul>
          </div>
        </header>
      </div>
      <div class="container main">
        <div class="page-body">
          <div class="markdown-body">
            <h2>OCaml简介第 2 部分</h2>
            <p>译自：<a href="https://qiita.com/zenwerk/items/603bd383fe5c6b8cace3">https://qiita.com/zenwerk/items/603bd383fe5c6b8cace3</a></p>
            <h3>递归多层数据结构。</h3>
            <p>列表类型</p>
            <pre><code class="language-ocaml"># <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token number">5</span><span class="token punctuation">]</span>
# <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">;</span> <span class="token string">"b"</span><span class="token punctuation">;</span> <span class="token string">"c"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> string list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">;</span> <span class="token string">"b"</span><span class="token punctuation">;</span> <span class="token string">"c"</span><span class="token punctuation">]</span>
<span class="token comment">(* 不同的类型不能存在于同一个列表 *)</span>
# <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token string">"a"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token module variable">Error</span><span class="token punctuation">:</span> <span class="token module variable">This</span> expression has <span class="token keyword">type</span> string but an expression was expected <span class="token keyword">of</span> <span class="token keyword">type</span> int
</code></pre>
            <h3>将值添加到列表的开头</h3>
            <p>使用consus操作符(::)。</p>
            <p>右结合</p>
            <pre><code class="language-ocaml"># <span class="token number">1</span> <span class="token punctuation">:</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">4</span><span class="token punctuation">]</span>

<span class="token comment">(* 右結合 *)</span>
# <span class="token number">1</span> <span class="token punctuation">:</span><span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">:</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">4</span><span class="token punctuation">]</span>
</code></pre>
            <h3>列表合并</h3>
            <p>使用 @ 。</p>
            <pre><code class="language-ocaml"># <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">@</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> <span class="token type_variable function">'a</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
# <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">@</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">]</span>
# <span class="token punctuation">[</span><span class="token string">"asdf"</span><span class="token punctuation">;</span> <span class="token string">"hoge"</span><span class="token punctuation">]</span> <span class="token operator">@</span> <span class="token punctuation">[</span><span class="token string">"fuga"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> string list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"asdf"</span><span class="token punctuation">;</span> <span class="token string">"hoge"</span><span class="token punctuation">;</span> <span class="token string">"fuga"</span><span class="token punctuation">]</span>
</code></pre>
            <h3>模式匹配</h3>
            <p>match 表达式</p>
            <p>match 表达式 with 模式1 - &gt;表达式 | 模式2 - &gt;表达式…</p>
            <p>找到整数列表的总和的例子:</p>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> <span class="token keyword">rec</span> total l <span class="token operator">=</span>
    <span class="token keyword">match</span> l <span class="token keyword">with</span>
      <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">-></span> <span class="token number">0</span>
    <span class="token operator">|</span> h <span class="token punctuation">:</span><span class="token punctuation">:</span> rest <span class="token operator">-></span> h <span class="token operator">+</span> <span class="token punctuation">(</span>total rest<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> total <span class="token punctuation">:</span> int list <span class="token operator">-></span> int <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
# total <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">15</span>
</code></pre>
            <p>反转列表的函数示例:</p>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> reverse l <span class="token operator">=</span>
    <span class="token keyword">let</span> <span class="token keyword">rec</span> innerReverse l1 l2 <span class="token operator">=</span>
      <span class="token keyword">match</span> l1 <span class="token keyword">with</span>
      <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">-></span> l2
      <span class="token operator">|</span> h <span class="token punctuation">:</span><span class="token punctuation">:</span> rest <span class="token operator">-></span> innerReverse rest <span class="token punctuation">(</span>h <span class="token punctuation">:</span><span class="token punctuation">:</span> l2<span class="token punctuation">)</span>
    <span class="token keyword">in</span>
    innerReverse l <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> reverse <span class="token punctuation">:</span> <span class="token type_variable function">'a</span> list <span class="token operator">-></span> <span class="token type_variable function">'a</span> list <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
# reverse <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">1</span><span class="token punctuation">]</span>
</code></pre>
            <h3>function 表达式</h3>
            <p>fun 和 match 通过组合定义一个匿名函数</p>
            <p>function 模式1 - &gt; 表达式 | 模式2 - &gt; 表达式…</p>
            <p>上面整数列表的总和的例子可以改写如下：</p>
            <p>当使用最后一个参数进行模式匹配时方便，并且该参数仅用于模式匹配</p>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> <span class="token keyword">rec</span> total <span class="token operator">=</span> <span class="token keyword">function</span>
    <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">-></span> <span class="token number">0</span>
  <span class="token operator">|</span> h <span class="token punctuation">:</span><span class="token punctuation">:</span> rest <span class="token operator">-></span> h <span class="token operator">+</span> <span class="token punctuation">(</span>total rest<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> total <span class="token punctuation">:</span> int list <span class="token operator">-></span> int <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
# total <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">15</span>
</code></pre>
            <h3>map 函数的例子</h3>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> <span class="token keyword">rec</span> map fn <span class="token operator">=</span> <span class="token keyword">function</span>
    <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">-></span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token operator">|</span> h <span class="token punctuation">:</span><span class="token punctuation">:</span> rest <span class="token operator">-></span> fn h <span class="token punctuation">:</span><span class="token punctuation">:</span> map fn rest<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> map <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token type_variable function">'a</span> <span class="token operator">-></span> <span class="token type_variable function">'b</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token type_variable function">'a</span> list <span class="token operator">-></span> <span class="token type_variable function">'b</span> list <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
# map <span class="token punctuation">(</span><span class="token keyword">fun</span> x <span class="token operator">-></span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token number">5</span><span class="token punctuation">]</span>
</code></pre>
            <h3>fold (折叠)函数例子</h3>
            <pre><code class="language-ocaml"><span class="token comment">(* 左fold *)</span>
# <span class="token keyword">let</span> <span class="token keyword">rec</span> foldl fn acc l <span class="token operator">=</span>
    <span class="token keyword">match</span> l <span class="token keyword">with</span>
    <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">-></span> acc
    <span class="token operator">|</span> h <span class="token punctuation">:</span><span class="token punctuation">:</span> rest <span class="token operator">-></span> foldl fn <span class="token punctuation">(</span>fn acc h<span class="token punctuation">)</span> rest<span class="token punctuation">;</span><span class="token punctuation">;</span>

<span class="token comment">(* 用于查找列表长度的 fold 示例 *)</span>
# foldl <span class="token punctuation">(</span><span class="token keyword">fun</span> acc x <span class="token operator">-></span> acc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">0</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">3</span>

<span class="token comment">(* 右fold *)</span>
# <span class="token keyword">let</span> <span class="token keyword">rec</span> foldr fn l acc <span class="token operator">=</span>
    <span class="token keyword">match</span> l <span class="token keyword">with</span>
    <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">-></span> acc
    <span class="token operator">|</span> h <span class="token punctuation">:</span><span class="token punctuation">:</span> rest <span class="token operator">-></span> fn h <span class="token punctuation">(</span>foldr fn rest acc<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> foldr <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token type_variable function">'a</span> <span class="token operator">-></span> <span class="token type_variable function">'b</span> <span class="token operator">-></span> <span class="token type_variable function">'b</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token type_variable function">'a</span> list <span class="token operator">-></span> <span class="token type_variable function">'b</span> <span class="token operator">-></span> <span class="token type_variable function">'b</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
</code></pre>
            <h3>模式匹配守卫子句</h3>
            <p>match 表达式 with 模式1 when 真/假表达式 - &gt;表达式| …</p>
            <p>使用 when。</p>
            <h3>注意：match，function 中没有关闭符号</h3>
            <p>在match with 和 function 上没有结束符号。</p>
            <p>因此，当模式匹配嵌套时，必须用（）等括起来</p>
            <h3>数据结构</h3>
            <h4>记录（record）</h4>
            <p>C语言结构，数据结构等同于 Python 字典。</p>
            <p>命名元素名称。</p>
            <h4>记录定义</h4>
            <ul>
              <li>type name = {field name：type; …}</li>
              <li>字段 - &gt; 名称和值对</li>
              <li>请注意，字段名称不能与其他记录重复</li>
            </ul>
            <pre><code class="language-ocaml"># <span class="token keyword">type</span> student <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> string<span class="token punctuation">;</span> id<span class="token punctuation">:</span> int<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> student <span class="token operator">=</span> <span class="token punctuation">{</span> name <span class="token punctuation">:</span> string<span class="token punctuation">;</span> id <span class="token punctuation">:</span> int<span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre>
            <h4>创建记录</h4>
            <ul>
              <li>{Field name = value; …}</li>
            </ul>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token punctuation">{</span>name <span class="token operator">=</span> <span class="token string">"hoge"</span><span class="token punctuation">;</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> s <span class="token punctuation">:</span> student <span class="token operator">=</span> <span class="token punctuation">{</span>name <span class="token operator">=</span> <span class="token string">"hoge"</span><span class="token punctuation">;</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">}</span>
</code></pre>
            <h3>记录转移</h3>
            <p>创建一个新的记录值，而不是覆盖现有的值。</p>
            <p>{记录 with 字段名称 = 值; …}</p>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token punctuation">{</span>s <span class="token keyword">with</span> name <span class="token operator">=</span> <span class="token string">"fuga"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> s2 <span class="token punctuation">:</span> student <span class="token operator">=</span> <span class="token punctuation">{</span>name <span class="token operator">=</span> <span class="token string">"fuga"</span><span class="token punctuation">;</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">}</span>
</code></pre>
            <h3>变体</h3>
            <p>数据结构代表案例分类。</p>
            <pre><code class="language-ocaml"><span class="token keyword">type</span> name <span class="token operator">=</span>
  <span class="token operator">|</span> 构造函数 <span class="token punctuation">[</span> <span class="token keyword">of</span> <span class="token operator">&lt;</span><span class="token keyword">type</span><span class="token operator">></span> <span class="token punctuation">[</span><span class="token operator">*</span> <span class="token operator">&lt;</span><span class="token keyword">type</span><span class="token operator">></span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span>
  <span class="token operator">|</span> 构造函数 <span class="token punctuation">[</span> <span class="token keyword">of</span> <span class="token operator">&lt;</span><span class="token keyword">type</span><span class="token operator">></span> <span class="token punctuation">[</span><span class="token operator">*</span> <span class="token operator">&lt;</span><span class="token keyword">type</span><span class="token operator">></span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span>
  <span class="token operator">|</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
            <ul>
              <li>构造函数以英文大写字母开头</li>
              <li>of 是构造函数所需的参数类型</li>
              <li>of int * int 参数不是一组 int ，两个 int</li>
              <li>of (int * int) 参数是一对 int</li>
            </ul>
            <p>以下是四种数字的变体类型：</p>
            <pre><code class="language-ocaml"># <span class="token keyword">type</span> figure <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token module variable">Point</span>
  <span class="token operator">|</span> <span class="token module variable">Circle</span> <span class="token keyword">of</span> int
  <span class="token operator">|</span> <span class="token module variable">Rectangle</span> <span class="token keyword">of</span> int <span class="token operator">*</span> int <span class="token comment">(* 两个 int 类型的参数，不是元组 *)</span>
  <span class="token operator">|</span> <span class="token module variable">Square</span> <span class="token keyword">of</span> int<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> figure <span class="token operator">=</span> <span class="token module variable">Point</span> <span class="token operator">|</span> <span class="token module variable">Circle</span> <span class="token keyword">of</span> int <span class="token operator">|</span> <span class="token module variable">Rectangle</span> <span class="token keyword">of</span> int <span class="token operator">*</span> int <span class="token operator">|</span> <span class="token module variable">Square</span> <span class="token keyword">of</span> int

# <span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token module variable">Circle</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> c <span class="token punctuation">:</span> figure <span class="token operator">=</span> <span class="token module variable">Circle</span> <span class="token number">4</span>
# <span class="token keyword">let</span> figs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token module variable">Point</span><span class="token punctuation">;</span> <span class="token module variable">Rectangle</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> c<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> figs <span class="token punctuation">:</span> figure list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token module variable">Point</span><span class="token punctuation">;</span> <span class="token module variable">Rectangle</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token module variable">Circle</span> <span class="token number">4</span><span class="token punctuation">]</span>
</code></pre>
            <h3>变体的模式匹配</h3>
            <h4>function | 构造函数的参数 -&gt; | …</h4>
            <p>省略参数部分意味着没有参数构造函数。</p>
            <pre><code class="language-ocaml"><span class="token comment">(* 计算图形面积的例子 *)</span>
# <span class="token keyword">let</span> area <span class="token operator">=</span> <span class="token keyword">function</span>
  <span class="token operator">|</span> <span class="token module variable">Point</span> <span class="token operator">-></span> <span class="token number">0</span>
  <span class="token operator">|</span> <span class="token module variable">Circle</span> r <span class="token operator">-></span> r <span class="token operator">*</span> r <span class="token operator">*</span> <span class="token number">3</span>
  <span class="token operator">|</span> <span class="token module variable">Rectangle</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-></span> x <span class="token operator">*</span> y
  <span class="token operator">|</span> <span class="token module variable">Square</span> x <span class="token operator">-></span> x <span class="token operator">*</span> x<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> area <span class="token punctuation">:</span> figure <span class="token operator">-></span> int <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
# area c<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">48</span>
</code></pre>
            <h3>多态变体类型</h3>
            <ul>
              <li>可以使用类型变量（ 'a 等）来定义变体类型，</li>
              <li>它也被称为带参数的参数。</li>
              <li>例如，'a list 可以使用多态变量来表示。</li>
            </ul>
            <pre><code class="language-ocaml"># <span class="token keyword">type</span> <span class="token type_variable function">'a</span> mylist <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token module variable">Nil</span>
  <span class="token operator">|</span> <span class="token module variable">Cons</span> <span class="token keyword">of</span> <span class="token type_variable function">'a</span> <span class="token operator">*</span> <span class="token type_variable function">'a</span> mylist<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token type_variable function">'a</span> mylist <span class="token operator">=</span> <span class="token module variable">Nil</span> <span class="token operator">|</span> <span class="token module variable">Cons</span> <span class="token keyword">of</span> <span class="token type_variable function">'a</span> <span class="token operator">*</span> <span class="token type_variable function">'a</span> mylist
# <span class="token module variable">Nil</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> <span class="token type_variable function">'a</span> mylist <span class="token operator">=</span> <span class="token module variable">Nil</span>

<span class="token comment">(* 表示一个整数列表 *)</span>
# <span class="token module variable">Cons</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Nil</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int mylist <span class="token operator">=</span> <span class="token module variable">Cons</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Nil</span><span class="token punctuation">)</span>

<span class="token comment">(* 表示字符列表 *)</span>
# <span class="token module variable">Cons</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token module variable">Cons</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token module variable">Nil</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> char mylist <span class="token operator">=</span> <span class="token module variable">Cons</span> <span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token module variable">Cons</span> <span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token module variable">Nil</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
            <h3>Optional</h3>
            <p>通常说可选，表明这些情况下没有值</p>
            <pre><code class="language-ocaml"># <span class="token keyword">type</span> <span class="token type_variable function">'a</span> option <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token module variable">None</span>
  <span class="token operator">|</span> <span class="token module variable">Some</span> <span class="token keyword">of</span> <span class="token type_variable function">'a</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token type_variable function">'a</span> option <span class="token operator">=</span> <span class="token module variable">None</span> <span class="token operator">|</span> <span class="token module variable">Some</span> <span class="token keyword">of</span> <span class="token type_variable function">'a</span>
</code></pre>
            <p>使用可选的示例</p>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> fact n <span class="token operator">=</span>
    <span class="token keyword">let</span> <span class="token keyword">rec</span> fact' n <span class="token operator">=</span> <span class="token keyword">if</span> n <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> n <span class="token operator">*</span> fact' <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">in</span>
    <span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token keyword">then</span> <span class="token module variable">None</span> <span class="token keyword">else</span> <span class="token module variable">Some</span> <span class="token punctuation">(</span>fact' n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> fact <span class="token punctuation">:</span> int <span class="token operator">-></span> int option <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
# fact <span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int option <span class="token operator">=</span> <span class="token module variable">Some</span> <span class="token number">6</span>
# fact <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int option <span class="token operator">=</span> <span class="token module variable">None</span>
</code></pre>
            <h3>递归变体类型</h3>
            <p>在构造函数中 of 下面是它自己的类型出现的变体类型</p>
            <h4>二叉树的例子</h4>
            <pre><code class="language-ocaml"># <span class="token keyword">type</span> <span class="token type_variable function">'a</span> btree <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token module variable">Leaf</span>
  <span class="token operator">|</span> <span class="token module variable">Node</span> <span class="token keyword">of</span> <span class="token type_variable function">'a</span> <span class="token operator">*</span> <span class="token type_variable function">'a</span> btree <span class="token operator">*</span> <span class="token type_variable function">'a</span> btree<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token type_variable function">'a</span> btree <span class="token operator">=</span> <span class="token module variable">Leaf</span> <span class="token operator">|</span> <span class="token module variable">Tree</span> <span class="token keyword">of</span> <span class="token type_variable function">'a</span> <span class="token operator">*</span> <span class="token type_variable function">'a</span> btree <span class="token operator">*</span> <span class="token type_variable function">'a</span> btree

# <span class="token module variable">Node</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Node</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token module variable">Node</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Node</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int btree <span class="token operator">=</span>
<span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
            <p>查找树的元素数量和高度的函数示例</p>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> tr <span class="token operator">=</span> <span class="token module variable">Node</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Node</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token module variable">Node</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Node</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>  
<span class="token keyword">val</span> tr <span class="token punctuation">:</span> int btree <span class="token operator">=</span>
  <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">(* 用于查找高度的函数 *)</span>
# <span class="token keyword">let</span> <span class="token keyword">rec</span> height <span class="token operator">=</span> <span class="token keyword">function</span>
  <span class="token operator">|</span> <span class="token module variable">Leaf</span> <span class="token operator">-></span> <span class="token number">0</span>
  <span class="token operator">|</span> <span class="token module variable">Node</span><span class="token punctuation">(</span><span class="token punctuation">_</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> right<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token number">1</span> <span class="token operator">+</span> max <span class="token punctuation">(</span>height left<span class="token punctuation">)</span> <span class="token punctuation">(</span>height right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> height <span class="token punctuation">:</span> <span class="token type_variable function">'a</span> btree <span class="token operator">-></span> int <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
# height tr<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">3</span>

<span class="token comment">(* 用于查找元素数目的函数 *)</span>
# <span class="token keyword">let</span> <span class="token keyword">rec</span> size <span class="token operator">=</span> <span class="token keyword">function</span>
  <span class="token operator">|</span> <span class="token module variable">Leaf</span> <span class="token operator">-></span> <span class="token number">0</span>
  <span class="token operator">|</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token punctuation">_</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> right<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token number">1</span> <span class="token operator">+</span> size left <span class="token operator">+</span> size right<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> size <span class="token punctuation">:</span> <span class="token type_variable function">'a</span> btree <span class="token operator">-></span> int <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
# size tr<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">4</span>
</code></pre>
            <h4>二叉搜索树的例子</h4>
            <ul>
              <li>添加元素</li>
            </ul>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> <span class="token keyword">rec</span> insert x <span class="token operator">=</span> <span class="token keyword">function</span>
  <span class="token operator">|</span> <span class="token module variable">Leaf</span> <span class="token operator">-></span> <span class="token module variable">Node</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span>
  <span class="token operator">|</span> <span class="token module variable">Node</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> left<span class="token punctuation">,</span> right<span class="token punctuation">)</span> <span class="token operator">-></span>
      <span class="token keyword">if</span> x <span class="token operator">&lt;</span> k <span class="token keyword">then</span> <span class="token module variable">Node</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> insert x left<span class="token punctuation">,</span> right<span class="token punctuation">)</span>
      <span class="token keyword">else</span> <span class="token module variable">Node</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> left<span class="token punctuation">,</span> insert x right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> insert <span class="token punctuation">:</span> <span class="token type_variable function">'a</span> <span class="token operator">-></span> <span class="token type_variable function">'a</span> btree <span class="token operator">-></span> <span class="token type_variable function">'a</span> btree <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
</code></pre>
            <ul>
              <li>搜索元素</li>
            </ul>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> <span class="token keyword">rec</span> mem x <span class="token operator">=</span> <span class="token keyword">function</span>
  <span class="token operator">|</span> <span class="token module variable">Leaf</span> <span class="token operator">-></span> <span class="token boolean">false</span>
  <span class="token operator">|</span> <span class="token module variable">Node</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> left<span class="token punctuation">,</span> right<span class="token punctuation">)</span> <span class="token operator">-></span>
      <span class="token keyword">if</span> x <span class="token operator">&lt;</span> k <span class="token keyword">then</span> mem x left
      <span class="token keyword">else</span> <span class="token keyword">if</span> x <span class="token operator">=</span> k <span class="token keyword">then</span> <span class="token boolean">true</span>
      <span class="token keyword">else</span> mem x right<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> mem <span class="token punctuation">:</span> <span class="token type_variable function">'a</span> <span class="token operator">-></span> <span class="token type_variable function">'a</span> btree <span class="token operator">-></span> bool <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
</code></pre>
            <ul>
              <li>使用例子</li>
            </ul>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> tr <span class="token operator">=</span> <span class="token module variable">Leaf</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> tr <span class="token punctuation">:</span> <span class="token type_variable function">'a</span> btree <span class="token operator">=</span> <span class="token module variable">Leaf</span>
# tr<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> <span class="token type_variable function">'a</span> btree <span class="token operator">=</span> <span class="token module variable">Leaf</span>
# insert <span class="token number">10</span> tr<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int btree <span class="token operator">=</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span>
# <span class="token keyword">let</span> tr <span class="token operator">=</span> insert <span class="token number">10</span> tr<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> tr <span class="token punctuation">:</span> int btree <span class="token operator">=</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span>
# <span class="token keyword">let</span> tr <span class="token operator">=</span> insert <span class="token number">5</span> tr<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> tr <span class="token punctuation">:</span> int btree <span class="token operator">=</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span>
# <span class="token keyword">let</span> tr <span class="token operator">=</span> insert <span class="token number">20</span> tr<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> tr <span class="token punctuation">:</span> int btree <span class="token operator">=</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token module variable">Node</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">,</span> <span class="token module variable">Leaf</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
# mem <span class="token number">5</span> tr<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> bool <span class="token operator">=</span> <span class="token boolean">true</span>
# mem <span class="token number">15</span> tr<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> bool <span class="token operator">=</span> <span class="token boolean">false</span>
</code></pre>
            <h3>玫瑰树的一个例子</h3>
            <p>玫瑰树是元素数量未知的树。</p>
            <p>它可以被认为是与 UNIX 相同的目录结构。</p>
            <ul>
              <li>类型定义</li>
            </ul>
            <pre><code class="language-ocaml"><span class="token comment">(* 由于子元素的数量是不确定的，节点的元素是列表 *)</span>
# <span class="token keyword">type</span> <span class="token type_variable function">'a</span> rosetree <span class="token operator">=</span> <span class="token module variable">RLeaf</span> <span class="token operator">|</span> <span class="token module variable">RNode</span> <span class="token keyword">of</span> <span class="token type_variable function">'a</span> <span class="token operator">*</span> <span class="token type_variable function">'a</span> rosetree list<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token type_variable function">'a</span> rosetree <span class="token operator">=</span> <span class="token module variable">RLeaf</span> <span class="token operator">|</span> <span class="token module variable">RNode</span> <span class="token keyword">of</span> <span class="token type_variable function">'a</span> <span class="token operator">*</span> <span class="token type_variable function">'a</span> rosetree list
</code></pre>
            <p>XML作为玫瑰树</p>
            <ul>
              <li>类型定义</li>
            </ul>
            <p>因为它是 XML ，叶子也没有价值 - &gt;（'b option）</p>
            <pre><code class="language-ocaml"><span class="token comment">(* 'a 标记, 'b 值 *)</span>
# <span class="token keyword">type</span> <span class="token punctuation">(</span><span class="token type_variable function">'a</span><span class="token punctuation">,</span> <span class="token type_variable function">'b</span><span class="token punctuation">)</span> xml <span class="token operator">=</span> <span class="token module variable">XLeaf</span> <span class="token keyword">of</span> <span class="token type_variable function">'b</span> option <span class="token operator">|</span> <span class="token module variable">XNode</span> <span class="token keyword">of</span> <span class="token type_variable function">'a</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token type_variable function">'a</span><span class="token punctuation">,</span> <span class="token type_variable function">'b</span><span class="token punctuation">)</span> xml list<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token punctuation">(</span><span class="token type_variable function">'a</span><span class="token punctuation">,</span> <span class="token type_variable function">'b</span><span class="token punctuation">)</span> xml <span class="token operator">=</span> <span class="token module variable">XLeaf</span> <span class="token keyword">of</span> <span class="token type_variable function">'b</span> option <span class="token operator">|</span> <span class="token module variable">XNode</span> <span class="token keyword">of</span> <span class="token type_variable function">'a</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token type_variable function">'a</span><span class="token punctuation">,</span> <span class="token type_variable function">'b</span><span class="token punctuation">)</span> xml list
</code></pre>
            <p>对XML数据结构进行字符串化的函数</p>
            <p>递归XML（Rose Tree）包含一个递归数据结构的列表</p>
            <p>它是相互递归的定义</p>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> <span class="token keyword">rec</span> string_of_xml <span class="token operator">=</span> <span class="token keyword">function</span>
  <span class="token operator">|</span> <span class="token module variable">XNode</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> xml_list<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token string">"&lt;"</span> <span class="token operator">^</span> tag <span class="token operator">^</span> <span class="token string">">"</span> <span class="token operator">^</span> string_of_xmllist xml_list <span class="token operator">^</span> <span class="token string">"&lt;/"</span> <span class="token operator">^</span> tag <span class="token operator">^</span> <span class="token string">">"</span>
  <span class="token operator">|</span> <span class="token module variable">XLeaf</span> <span class="token module variable">None</span> <span class="token operator">-></span> <span class="token string">""</span>
  <span class="token operator">|</span> <span class="token module variable">XLeaf</span><span class="token punctuation">(</span><span class="token module variable">Some</span> s<span class="token punctuation">)</span> <span class="token operator">-></span> s
  <span class="token operator">and</span>
  string_of_xmllist <span class="token operator">=</span> <span class="token keyword">function</span>
  <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">-></span> <span class="token string">""</span>
  <span class="token operator">|</span> xml <span class="token punctuation">:</span><span class="token punctuation">:</span> rest <span class="token operator">-></span> string_of_xml xml <span class="token operator">^</span> string_of_xmllist rest<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> string_of_xml <span class="token punctuation">:</span> <span class="token punctuation">(</span>string<span class="token punctuation">,</span> string<span class="token punctuation">)</span> xml <span class="token operator">-></span> string <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
<span class="token keyword">val</span> string_of_xmllist <span class="token punctuation">:</span> <span class="token punctuation">(</span>string<span class="token punctuation">,</span> string<span class="token punctuation">)</span> xml list <span class="token operator">-></span> string <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
</code></pre>
            <h3>无限的列</h3>
            <h4>整数的无限列的例子</h4>
            <pre><code class="language-ocaml"># <span class="token keyword">type</span> intseq <span class="token operator">=</span> <span class="token module variable">Cons</span> <span class="token keyword">of</span> int <span class="token operator">*</span> <span class="token punctuation">(</span>int <span class="token operator">-></span> intseq<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> intseq <span class="token operator">=</span> <span class="token module variable">Cons</span> <span class="token keyword">of</span> int <span class="token operator">*</span> <span class="token punctuation">(</span>int <span class="token operator">-></span> intseq<span class="token punctuation">)</span>
</code></pre>
            <ul>
              <li>无限列的示例递增</li>
            </ul>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> <span class="token keyword">rec</span> f x <span class="token operator">=</span> <span class="token module variable">Cons</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> f <span class="token punctuation">:</span> int <span class="token operator">-></span> intseq <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
# f <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> intseq <span class="token operator">=</span> <span class="token module variable">Cons</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span><span class="token punctuation">)</span>
# f <span class="token number">100</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> intseq <span class="token operator">=</span> <span class="token module variable">Cons</span> <span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span><span class="token punctuation">)</span>
</code></pre>
            <ul>
              <li>
                <p>如果返回值的 x 是下一个元素</p>
                <p>通过给x作为参数，我们得到元素的顺序</p>
              </li>
            </ul>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> <span class="token module variable">Cons</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> f<span class="token punctuation">)</span> <span class="token operator">=</span> f <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> x <span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">val</span> f <span class="token punctuation">:</span> int <span class="token operator">-></span> intseq <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
# <span class="token keyword">let</span> <span class="token module variable">Cons</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> f<span class="token punctuation">)</span> <span class="token operator">=</span> f x<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> x <span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">val</span> f <span class="token punctuation">:</span> int <span class="token operator">-></span> intseq <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
# <span class="token keyword">let</span> <span class="token module variable">Cons</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> f<span class="token punctuation">)</span> <span class="token operator">=</span> f x<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> x <span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">3</span>
<span class="token keyword">val</span> f <span class="token punctuation">:</span> int <span class="token operator">-></span> intseq <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
</code></pre>
            <ul>
              <li>获取第 N 个元素函数</li>
            </ul>
            <pre><code class="language-ocaml"># <span class="token keyword">let</span> <span class="token keyword">rec</span> nthseq n <span class="token punctuation">(</span><span class="token module variable">Cons</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span>
    <span class="token keyword">if</span> n <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">then</span> x
    <span class="token keyword">else</span> nthseq <span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>f x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">val</span> nthseq <span class="token punctuation">:</span> int <span class="token operator">-></span> intseq <span class="token operator">-></span> int <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token keyword">fun</span><span class="token operator">></span>
# nthseq <span class="token number">10</span> <span class="token punctuation">(</span>f <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">10</span>
</code></pre>

          </div>
        </div>
      </div>
    </div>
  </body>

</html>